from pymongo import MongoClient
import time

#connect to mongo and create connection to PIP database
client = MongoClient('mongodb+srv://cowen:compproject@cluster0.1qgln.mongodb.net/Cluster0?retryWrites=true&w=majority')
db = client.rooms
count = 0


iteration_count = 0
temp = []
humidity = []
light = []

result = db.PIPdata.find_one()
print(result)
temp.append(result['Temperature'])
humidity.append(result['Humidity'])
light.append(result['Light'])
data = [result['Temperature'], 2, 3, 4, 5, 6, 7]
with open('html_test.html', 'w') as f:
    f.write(
            """
            
<canvas id="myChart"></canvas>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script>    
var ctx = document.getElementById('myChart').getContext('2d');
var chart = new Chart(ctx, {
    // The type of chart we want to create
    type: 'line',

    // The data for our dataset
    data: {
        labels: ['t1', 't2', 't3', 't4', 't5', 't6', 't7'],
        datasets: [{
            label: 'Temperature',
            backgroundColor: 'rgb(236, 219, 83)',
            fill: false,
            borderColor: 'rgb(236, 219, 83)',
            data: [0, 10, 5, 2, 20, 30, 40]
        },
        {
            label: 'Humidity',
            backgroundColor: 'rgb(227, 65, 50)',
            fill: false,
            borderColor: 'rgb(227, 65, 50)',
            data: [3, 5, 8, 10, 12, 15, 16]
        },
        {
            label: 'Light',
            backgroundColor: 'rgb(108, 60, 220',
            fill: false,
            borderColor: 'rgb(108, 60, 220)',
            data: [4, 8, 9, 3, 15, 4, 10]
        }
        ]
    },

    // Configuration options go here
    options: {
        animation: {
            duration: 0
        }
    }
});

window.setTimeout(function () {
  window.location.reload();
}, 3000);



</script>
            """.format(one=data[0], two=data[1], three=data[2], four=data[3], five=data[4], six=data[5], seven=data[6])
        )

f.close()

if(iteration_count==6):
    temp.pop(0)
    humidity.pop(0)
    light.pop(0)
    count-=count
